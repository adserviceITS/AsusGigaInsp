@model AsusGigaInsp.Models.SOListModels
@{
    ViewBag.Title = "オーダー検索";
}
<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/themes/base/jquery-ui.min.css">
    <link href="~/Content/SOList.css" rel="stylesheet" />
</head>
@Html.ValidationSummary()
@using (Html.BeginForm(new { autocomplete = "off" }))
{
    <div style="color:Red">
        @Html.Encode(TempData["msg"])
    </div>

    <!------------------------------------------------------------- 検索条件 ------------------------------------------------------------------>
    <div class="form-row">
        <label for="SrchSONO" class="col-form-label-sm">SO#</label>
        @Html.TextBoxFor(model => model.SrchSONO, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "" })
        <label for="Srch90N" class="col-form-label-sm">90N</label>
        @Html.TextBoxFor(model => model.Srch90N, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "" })
        <label for="SrchModelName" class="col-form-label-sm">ModelName</label>
        @Html.TextBoxFor(model => model.SrchModelName, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "" })
        <label for="SrchN01NO" class="col-form-label-sm">N01#</label>
        @Html.TextBoxFor(model => model.SrchN01NO, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "" })
    </div>

    <div class="form-row">
        <label for="SrchEstArrivalDate_S" class="col-form-label-sm">ADS到着予定日</label>
        @Html.TextBoxFor(model => model.SrchEstArrivalDate_S, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "From", id = "SrchEstArrivalDate_S" })
        <label for="SrchEstArrivalDate_E" class="col-form-label-sm">～</label>
        @Html.TextBoxFor(model => model.SrchEstArrivalDate_E, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "To", id = "SrchEstArrivalDate_E" })
        <label for="SrchPrefReportingDate_S" class="col-form-label-sm">レポート提出希望日</label>
        @Html.TextBoxFor(model => model.SrchPrefReportingDate_S, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "From", id = "SrchPrefReportingDate_S" })
        <label for="SrchPrefReportingDate_E" class="col-form-label-sm">～</label>
        @Html.TextBoxFor(model => model.SrchPrefReportingDate_E, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "To", id = "SrchPrefReportingDate_E" })
    </div>

    <div class="form-row">
        <label for="SrchEstArrivalDate_S" class="col-form-label-sm">SI/TEK到着予定日</label>
        @Html.TextBoxFor(model => model.SrchSiTekEstArrivalDate_S, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "From", id = "SrchSiTekEstArrivalDate_S" })
        <label for="SrchEstArrivalDate_E" class="col-form-label-sm">～</label>
        @Html.TextBoxFor(model => model.SrchSiTekEstArrivalDate_E, null, new { @class = "form-control form-control-sm", style = "max-width:150px;", placeholder = "To", id = "SrchSiTekEstArrivalDate_E" })
        <label for="SrchStatusID" class="col-form-label-sm">ステータス</label>
        @Html.DropDownListFor(
            model => model.SrchStatusID, // プロパティ
            new SelectList(Model.DropDownListStatusName, "SOStatusID", "SOStatusName"),
            "",
            new { @class= "form-control form-control-sm", style="max-width:200px;" }
        )
    </div>

    <div class="form-row">
        <label for="SrchStatusID" class="col-form-label-sm">日付チェック</label>
        @Html.DropDownListFor(
         model => model.SrchDateError, // プロパティ
         (IEnumerable<SelectListItem>)ViewBag.DropDownDateError,
         "",
         new { @class = "form-control form-control-sm", style = "max-width:200px;" }
        )
    </div>

    <div style="float: left; margin-bottom:2px;">
        <input type="button" class="btn btn-danger" onclick="location.href='@Url.Action("SOListUpLoad", "SOList")'" value="オーダー情報取り込み" />
    </div>
    <div style="float: right; margin-bottom:2px;">
        <input type="submit" class="btn btn-primary" formaction="/SOList/SOListSearchResult" name="Search" value="検索">
        <input type="button" class="btn btn-primary" name="Clear" id="ClearBtn" value="クリア">
    </div>

    <!------------------------------------------------------ ここから検索結果 ------------------------------------------------------------------>
    <table id="So-List" class="table table-striped table-bordered table-sm table-hover">
        <thead class="thead-light">
            <tr>
                <th></th>
                <th></th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().SONO)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().n90N)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().ModelName)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().ShippingQuantity)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().FixedShippingQuantity)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().EstArrivalDate)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().PrefReportingDate)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().SiTekEstArrivalDate)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().DeliveryLocation)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().CompleteWorkUnit)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().DOAUnit)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().HoldUnit)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().N01NO)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().SOStatusName)</th>
                <th>@Html.DisplayNameFor(model => model.SrchRstOrderList.First().STChangeDate)</th>
            </tr>
        </thead>
        <tbody>
            @if (Model.SrchRstOrderList != null)
            {
                foreach (var item in Model.SrchRstOrderList)
                {
                    string StrClass = null;

                    if (item.RecordKBN == "1")
                    {
                        StrClass = "table-danger";
                    }
                    else if (item.RecordKBN == "2")
                    {
                        StrClass = "table-warning";
                    }
                    else
                    {
                        StrClass = "table-primary";
                    }

                    <tr class="@StrClass">
                        <td>
                            <input type="submit" class="btn btn-primary btn-sm" name="SOListUpdateLink" formaction="/SOList/SOListUpdate?SONO=@(item.SONO)" value="編集" />
                        </td>
                        <td>
                            @if (string.Compare("4010", item.SOStatusID) <= 0)
                            {
                                <input type="button" class="btn btn-success btn-sm" onclick="location.href='@Url.Action("Export", "SOList", new { SONO =  item.SONO })'" value="レポート" />
                            }
                        </td>
                        <td>@Html.DisplayFor(modelItem => item.SONO)</td>
                        @if (item.CHGn90NFLG == "1")
                        {
                            <td class="bg-warning">@Html.DisplayFor(modelItem => item.n90N)</td>
                        }
                        else
                        {
                            <td>@Html.DisplayFor(modelItem => item.n90N)</td>
                        }
                        @if (item.CHGModelNameFLG == "1")
                        {
                            <td class="bg-warning">@Html.DisplayFor(modelItem => item.ModelName)</td>
                        }
                        else
                        {
                            <td>@Html.DisplayFor(modelItem => item.ModelName)</td>
                        }
                        @if (item.CHGShippingQuantityFLG == "1")
                        {
                            <td class="bg-warning">@Html.DisplayFor(modelItem => item.ShippingQuantity)</td>
                        }
                        else
                        {
                            <td>@Html.DisplayFor(modelItem => item.ShippingQuantity)</td>
                        }
                        <td>@Html.DisplayFor(modelItem => item.FixedShippingQuantity)</td>
                        @if (item.EstArrivalDateWarningFLG == "1")
                        {
                            <td class="bg-danger" style="color:white">@Html.DisplayFor(modelItem => item.EstArrivalDate)</td>
                        }
                        else
                        {
                            if (item.CHGEstArrivalDateFLG == "1")
                            {
                                <td class="bg-warning">@Html.DisplayFor(modelItem => item.EstArrivalDate)</td>
                            }
                            else
                            {
                                <td>@Html.DisplayFor(modelItem => item.EstArrivalDate)</td>
                            }
                        }
                        @if (item.PrefReportingDateWarningFLG == "1")
                        {
                            <td class="bg-danger" style="color:white">@Html.DisplayFor(modelItem => item.PrefReportingDate)</td>
                        }
                        else
                        {
                            if (item.CHGPrefReportingDateFLG == "1")
                            {
                                <td class="bg-warning">@Html.DisplayFor(modelItem => item.PrefReportingDate)</td>
                            }
                            else
                            {
                                <td>@Html.DisplayFor(modelItem => item.PrefReportingDate)</td>
                            }
                        }
                        @if (item.SiTekEstArrivalDateWarningFLG == "1")
                        {
                            <td class="bg-danger" style="color:white">@Html.DisplayFor(modelItem => item.SiTekEstArrivalDate)</td>
                        }
                        else
                        {
                            if (item.CHGSiTekEstArrivalDateFLG == "1")
                            {
                                <td class="bg-warning">@Html.DisplayFor(modelItem => item.SiTekEstArrivalDate)</td>
                            }
                            else
                            {
                                <td>@Html.DisplayFor(modelItem => item.SiTekEstArrivalDate)</td>
                            }
                        }
                        @if (item.CHGDeliveryLocationFLG == "1")
                        {
                            <td class="bg-warning">@Html.DisplayFor(modelItem => item.DeliveryLocation)</td>
                        }
                        else
                        {
                            <td>@Html.DisplayFor(modelItem => item.DeliveryLocation)</td>
                        }
                        <td>@Html.DisplayFor(modelItem => item.CompleteWorkUnit)</td>
                        <td>@Html.DisplayFor(modelItem => item.DOAUnit)</td>
                        <td>@Html.DisplayFor(modelItem => item.HoldUnit)</td>
                        @if (item.CHGN01NoFLG == "1")
                        {
                            <td class="bg-warning">@Html.DisplayFor(modelItem => item.N01NO)</td>
                        }
                        else
                        {
                            <td>@Html.DisplayFor(modelItem => item.N01NO)</td>
                        }
                        <td>@Html.DisplayFor(modelItem => item.SOStatusName)</td>
                        <td>@Html.DisplayFor(modelItem => item.STChangeDate)</td>
                    </tr>
                }
            }
        </tbody>
    </table>
}
<script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js" defer></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tablesorter/2.31.0/js/jquery.tablesorter.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" defer></script>
<script src="https://ajax.googleapis.com/ajax/libs/jqueryui/1/i18n/jquery.ui.datepicker-ja.min.js" defer></script>
<script type="text/javascript">

    // クリアボタンクリック処理
    $("#ClearBtn").on("click", function () {
        clearForm(this.form);
    });

    // ソート処理
    $(document).ready(function () {
        $('#So-List').tablesorter({
            headers: {
                0: { sorter: false },
                1: { sorter: false }
            }
        });
    });

    // ADS到着予定日Fromクリック処理
    $('#SrchEstArrivalDate_S').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

    // ADS到着予定日Toクリック処理
    $('#SrchEstArrivalDate_E').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

    // レポート提出希望日Fromクリック処理
    $('#SrchPrefReportingDate_S').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

    // レポート提出希望日Toクリック処理
    $('#SrchPrefReportingDate_E').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

    // SI/TEK到着予定日Fromクリック処理
    $('#SrchSiTekEstArrivalDate_S').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

    // SI/TEK到着予定日Toクリック処理
    $('#SrchSiTekEstArrivalDate_E').datepicker({
        dateFormat: 'yy/mm/dd',
        showButtonPanel: true,
        changeMonth: true,
        changeYear: true,
        showOtherMonths: true
    });

</script>
